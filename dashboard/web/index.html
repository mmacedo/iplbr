<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Dashboard</title>

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/favicons/manifest.json">
  <link rel="shortcut icon" href="/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">
  <meta name="msapplication-config" content="/favicons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">

  <!-- http://bootswatch.com/journal/ -->
  <link href="css/bootstrap-3.3.5.min.css" rel="stylesheet">

  <style type="text/css">
    .navbar-static-top { margin-bottom: 0; }
    .tab { display: none; }
    .tab.active { display: block; }
    iframe {
      width: 100%;
      background-color: transparent;
      border: 0px none transparent;
      padding: 0px;
      overflow: hidden;
    }
  </style>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body>
  <nav class="navbar navbar-default navbar-static-top">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a id="brand" class="navbar-brand" href="">Dashboard</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
        </ul>
      </div>
    </div>
  </nav>

  <div id="content">
  </div>

  <script src="js/jquery-1.11.3.min.js"></script>
  <script src="js/bootstrap-3.3.5.min.js"></script>
  <script src="js/ie10-viewport-bug-workaround.js"></script>
  <script src="js/iframeResizer.min.js"></script>
  <script src="js/lodash-3.10.0.min.js"></script>

  <script type="text/javascript">
    jQuery(function($) {
      $.getJSON('/tabs.json').done(function(json) {
        var $nav  = $('#navbar > ul.nav').empty();
        var $tabs = $('#content').empty();
        var navTmpl = _.template(
          '<li id="show_<%- id %>">' +
          '<a href="#<%- id %>"><%- title %></a>' +
          '</li>');
        var tabTmpl = _.template(
          '<div id="<%- id %>" class="tab">' +
          '<iframe src="<%- url %>" scrolling="no"></iframe>' +
          '</div>');
        _.each(json, function(value, key) {
          var title = key, id = _.kebabCase(title), url = value;
          var context = { id: id, title: title, url: url };
          $nav.append(navTmpl(context));
          $tabs.append(tabTmpl(context));
        });
        iFrameResize();

        function showTab(tab) {
          $('.tab').removeClass('active');
          $('#navbar li').removeClass('active');
          if (tab != null) {
            $('#' + tab).addClass('active');
            return $('#show_' + tab).addClass('active').find('a').text();
          }
          return null;
        }

        $(document).on('click', '#brand', function(e) {
          if (e.ctrlKey === true || e.shiftKey === true) {
            return;
          }
          showTab(null);
          history.pushState({ tab: null }, 'Dashboard', $('#brand').attr('href'));
        });

        $(document).on('click', '#navbar a', function(e) {
          if (e.ctrlKey === true || e.shiftKey === true) {
            return;
          }
          var hash = $(this).attr('href'), tab = hash.slice(1);
          history.pushState({ tab: tab }, showTab(tab), hash);
        });

        if (history.state == null) {
          var hash = window.location.hash ? window.location.hash.replace(/^#/, '') : '';
          var state = { tab: hash || null };
          var title = showTab(state.tab);
          if (hash.length > 0) {
            history.replaceState(state, title, '#' + hash);
          } else {
            history.replaceState(state, title);
          }
        } else {
          showTab(history.state.tab);
        }

        window.onpopstate = function(e) {
          if (e.state == null) {
            return;
          }
          showTab(e.state.tab);
        };

      });
    });
  </script>
</body>
</html>
