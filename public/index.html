<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="author" content="Michel Pavan Macedo">

  <title>Índice de Poder Legislativo</title>

  <!--Icons-->
  <link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon-180x180.png">
  <link rel="shortcut icon" href="favicons/favicon.ico">
  <link rel="icon" type="image/png" href="favicons/favicon-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="favicons/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="favicons/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="favicons/mstile-144x144.png">
  <meta name="msapplication-config" content="favicons/browserconfig.xml">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  <!-- Bootstrap -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/bootstrap-theme.min.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-26194428-1', 'michelpm.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>

  <style>
    body { text-align: center; }

    .grafico {
      width: 100%;
      height: 600px;
    }
  </style>
</head>
<body>
  <div class="container">

    <h1>Índice de Poder Legislativo</h1>

    <div role="tabpanel">

      <!-- Nav tabs -->
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active">
          <a href="#tab_nacional" aria-controls="tab_nacional" role="tab" data-toggle="tab">Nacional</a>
        </li>
        <li role="presentation">
          <a href="#tab_federal" aria-controls="tab_federal" role="tab" data-toggle="tab">Federal</a>
        </li>
        <li role="presentation">
          <a href="#tab_estadual" aria-controls="tab_estadual" role="tab" data-toggle="tab">Estadual</a>
        </li>
        <li role="presentation">
          <a href="#tab_municipal" aria-controls="tab_municipal" role="tab" data-toggle="tab">Municipal</a>
        </li>
      </ul>

      <!-- Tab panes -->
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="tab_nacional">
          <div id="indice_nacional" class="grafico"></div>
        </div>
        <div role="tabpanel" class="tab-pane fade in" id="tab_federal">
          <div id="indice_federal" class="grafico"></div>
          <div id="deputados_federais" class="grafico"></div>
          <div id="senadores" class="grafico"></div>
          <div id="congresso_nacional" class="grafico"></div>
          <div id="presidentes" class="grafico"></div>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="tab_estadual">
          <div id="indice_estadual" class="grafico"></div>
          <div id="deputados_estaduais" class="grafico"></div>
          <div id="governadores" class="grafico"></div>
          <div id="governadores_peso" class="grafico"></div>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="tab_municipal">
          <div id="indice_municipal" class="grafico"></div>
          <div id="vereadores" class="grafico"></div>
          <div id="prefeitos" class="grafico"></div>
          <div id="prefeitos_peso" class="grafico"></div>
        </div>
      </div>

    </div>

  </div>

  <!-- jQuery -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="js/jquery.min.js"%3E%3C/script%3E'))</script>

  <!-- Bootstrap -->
  <script src="js/bootstrap.min.js"></script>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <script src="js/ie10-viewport-bug-workaround.js"></script>

  <!-- Highcharts -->
  <script src="//code.highcharts.com/highcharts.js"></script>
  <script>!window.jQuery.fn.highcharts && document.write(unescape('%3Cscript src="js/highcharts.js"%3E%3C/script%3E'))</script>
  <script src="js/exporting.js"></script>
  <script src="js/grid-light.js"></script>

  <!-- Lazy.js -->
  <script src="js/lazy.min.js"></script>
  <script src="js/indice.js"></script>

  <script type="text/javascript">
    function criaGrafico(id, titulo, subtitulo, indice) {
      $(id).highcharts({
        chart: { type: 'spline' },
        title: { text: titulo },
        subtitle: { text: subtitulo },
        xAxis: { categories: indice.categories() },
        yAxis: {
          title: { text: '%' },
          min: 0
        },
        tooltip: {
          crosshairs: true,
          shared: true,
          valueDecimals: 2
        },
        series: indice.series()
      });
    }

    $(function() {
      $.getJSON("eleitos.json").done(function(json) {

        var indice = new Indice(json);

        // fix dimensions of chart that was in a hidden element
        $(document).on('shown.bs.tab', 'a[data-toggle="tab"]', function (e) {
          var panel_id = $(this).attr('aria-controls');
          $("#" + panel_id + " [data-highcharts-chart]").each(function() {
              $(this).highcharts().reflow();
          });
        });

        var indiceNacional = indice.indiceNacional();
        criaGrafico("#indice_nacional", 'Índice Nacional', 'Federal / 3 + Estadual / 3 + Municipal / 3', indiceNacional);

        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
          console.log(e.target);
        });

        $('a[data-toggle="tab"][aria-controls="tab_federal"]').on('shown.bs.tab', function (e) {

          if ($("#indice_federal").highcharts() != null) {
            return;
          }

          var indiceFederal = indice.indiceFederal();
          criaGrafico("#indice_federal", 'Índice Federal', 'deputados federais = 75% e presidentes = 25%', indiceFederal);

          var deputadosFederais = indice.deputadosFederais();
          criaGrafico("#deputados_federais", 'Câmara dos Deputados', null, deputadosFederais);

          var senadores = indice.senadores();
          criaGrafico("#senadores", 'Senado Federal', null, senadores);

          var congressoNacional = indice.congressoNacional();
          criaGrafico("#congresso_nacional", 'Congresso Nacional', 'Câmara dos Deputados + Senado Federal', congressoNacional);

          var presidentes = indice.presidentes();
          criaGrafico("#presidentes", 'Presidência da República', null, presidentes);

        });


        $('a[data-toggle="tab"][aria-controls="tab_estadual"]').on('shown.bs.tab', function (e) {

          if ($("#indice_estadual").highcharts() != null) {
            return;
          }

          var indiceEstadual = indice.indiceEstadual();
          criaGrafico("#indice_estadual", 'Índice Estadual', 'deputados estaduais = 75% e governadores = 25%', indiceEstadual);

          var deputadosEstaduais = indice.deputadosEstaduais();
          criaGrafico("#deputados_estaduais", 'Assembléias Legislativas Estaduais ou Distritais', null, deputadosEstaduais);

          var governadores = indice.governadores();
          criaGrafico("#governadores", 'Governos Estaduais', null, governadores);

          var governadoresComPeso = indice.governadoresComPeso();
          criaGrafico("#governadores_peso", 'Governos Estaduais', 'peso = número de deputados estaduais ou distritais', governadoresComPeso);

        });


        $('a[data-toggle="tab"][aria-controls="tab_municipal"]').on('shown.bs.tab', function (e) {

          if ($("#indice_municipal").highcharts() != null) {
            return;
          }

          var indiceMunicipal = indice.indiceMunicipal();
          criaGrafico("#indice_municipal", 'Índice Municipal', 'vereadores = 75% e prefeitos = 25%', indiceMunicipal);

          var vereadores = indice.vereadores();
          criaGrafico("#vereadores", 'Câmaras Municipais', null, vereadores);

          var prefeitos = indice.prefeitos();
          criaGrafico("#prefeitos", 'Prefeituras', null, prefeitos);

          var prefeitosComPeso = indice.prefeitosComPeso();
          criaGrafico("#prefeitos_peso", 'Prefeituras', 'peso = número de vereadores', prefeitosComPeso);

        });

      });
    });
  </script>
</body></html>
